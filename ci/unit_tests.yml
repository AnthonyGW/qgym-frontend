platform: linux

image_resource:
  type: docker-image
  source:
    repository: markadams/chromium-xvfb-js
    tag: 'latest'

inputs:
- name: qgym_repo
- name: npm_repo_cache
  path: /cache

outputs:
- name: test_coverage

run:
  path: sh
  args:
  - -exc
  - |
    mv cache/node_modules qgym_repo
    cd qgym_repo/
    npm run test:prod-headless -- --code-coverage
